"use strict";var __awaiter=this&&this.__awaiter||function(e,r,t,i){return new(t||(t=Promise))((function(s,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var r;e.done?s(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(n,o)}l((i=i.apply(e,r||[])).next())}))},__rest=this&&this.__rest||function(e,r){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&r.indexOf(i)<0&&(t[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)r.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(t[i[s]]=e[i[s]])}return t};Object.defineProperty(exports,"__esModule",{value:!0}),exports.setFromValue=void 0;
// monorepo
const convert_case_1=require("convert-case"),fs_util_1=require("fs-util"),read_json_file_1=require("read-json-file"),read_csv_file_1=require("read-csv-file"),csv_util_1=require("csv-util"),markdown_parse_js_1=require("markdown-parse-js"),read_markdown_file_1=require("read-markdown-file"),key_value_markdown_js_1=require("key-value-markdown-js"),read_kvmd_file_1=require("read-kvmd-file"),setFromValue=({informationPath:e,model:r,getJson:t,defaultDbStorageMethod:i,id:s})=>__awaiter(void 0,void 0,void 0,(function*(){const a=(0,convert_case_1.kebabCase)(r),n=`${a}s`;if("csv"===i){const r=`${n}.csv`,i=fs_util_1.path.resolve(e,r),s=(yield(0,read_csv_file_1.readCsvFile)(i))||[],a=t(s),o=(0,csv_util_1.csvItemToString)(a);return yield fs_util_1.fs.writeFile(i,o,"utf8"),{success:!0}}if("jsonSingle"===i){const r=`${a}-${s}.json`,i=fs_util_1.path.resolve(e,n,r),o=yield(0,read_json_file_1.readJsonFile)(i),l=!!o,_=t(o),u=JSON.stringify(_,null,2);return yield fs_util_1.fs.writeFile(i,u,"utf8"),{overwrite:l,success:!0}}if("jsonMultiple"===i){const r=`${n}.json`,i=fs_util_1.path.resolve(e,r),s=(yield(0,read_json_file_1.readJsonFile)(i))||[],a=t(s),o=JSON.stringify(a,null,2);return yield fs_util_1.fs.writeFile(i,o,"utf8"),{success:!0}}if("keyValueMarkdown"===i){const r=`${n}.md`,i=fs_util_1.path.resolve(e,r),s=(yield(0,read_kvmd_file_1.readKvmdFile)(i))||{data:[],parameters:{}},a=t(s.data);s.data=a;const o=(0,key_value_markdown_js_1.kvmdParseToMarkdownString)(s);return yield fs_util_1.fs.writeFile(i,o,"utf8"),{success:!0}}if("markdown"===i){const r=`${a}-${s}.md`,i=fs_util_1.path.join(e,n,r),o=yield(0,read_markdown_file_1.readMarkdownFile)(i),l=!!o,_=o?Object.assign({markdown:o.raw},o.parameters):null,u=t(_)[0],{markdown:d}=u,f={parameters:__rest(u,["markdown"]),raw:d},c=(0,markdown_parse_js_1.markdownParseToMarkdownString)(f);return yield fs_util_1.fs.writeFile(i,c,"utf8"),{success:!0,overwrite:l}}}));exports.setFromValue=setFromValue;
//# sourceMappingURL=setFromValue.js.map