"use strict";var __awaiter=this&&this.__awaiter||function(e,r,t,a){return new(t||(t=Promise))((function(i,n){function s(e){try{l(a.next(e))}catch(e){n(e)}}function o(e){try{l(a.throw(e))}catch(e){n(e)}}function l(e){var r;e.done?i(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(s,o)}l((a=a.apply(e,r||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeGet=void 0;const js_util_1=require("js-util"),fs_util_1=require("fs-util"),read_json_file_1=require("read-json-file"),read_csv_file_1=require("read-csv-file"),read_markdown_file_1=require("read-markdown-file"),key_value_markdown_js_1=require("key-value-markdown-js"),getDatabaseFiles_1=require("./getDatabaseFiles"),makeGet=e=>(r,t)=>__awaiter(void 0,void 0,void 0,(function*(){var a;const i=null==e?void 0:e.defaultDbStorageMethods[r],n=null===(a=null==e?void 0:e.defaults)||void 0===a?void 0:a[r],s=(0,js_util_1.mergeObjectParameters)(t,n),o=(yield(0,getDatabaseFiles_1.getDatabaseFiles)(r,s)).map((e=>__awaiter(void 0,void 0,void 0,(function*(){const r=fs_util_1.path.parse(e).ext;if(".json"===r){return(0,read_json_file_1.readJsonFile)(e)}if(".csv"===r){return(0,read_csv_file_1.readCsvFile)(e)}if(".md"===r){const r=yield(0,read_markdown_file_1.readMarkdownFile)(e);if(!r)return null;const t=null==r?void 0:r.parameters;if("markdown"===i){return Object.assign(Object.assign({},t),{markdown:r.raw})}return(0,key_value_markdown_js_1.kvMdStringToJson)(r.raw).data}
// NB: should never happen
return null}))));return(yield Promise.all(o)).filter(js_util_1.notEmpty).map((e=>(0,js_util_1.makeArray)(e))).flat()}));exports.makeGet=makeGet;
//# sourceMappingURL=makeGet.js.map