"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.frontmatterToObject=void 0;var name_conventions_1=require("name-conventions"),marked_util_1=require("marked-util"),js_util_1=require("js-util"),parseFrontmatterString_1=require("./parseFrontmatterString"),markdown_types_1=require("markdown-types"),frontmatterToObject=function(e,r){if(!r.properties||!r.properties.length)return{};var t=r.properties.map((function(r){var t,n,a,i,m,s,o,u,p,l=e[r.name]?e[r.name].trim():void 0;if(void 0!==l){var c=(0,name_conventions_1.getAssetInputType)(r.name);if(("object"===r.schema.type||"array"===r.schema.type)&&(null==c?void 0:c.type)){
// it's a backendAsset
var f=(0,marked_util_1.findEmbeds)(l).map((function(e){return{alt:e.alt,relativePath:e.src}}));if(0===f.length)return;return c.isMultiple?((t={})[r.name]=f,t):((n={})[r.name]=f[0],n)}if("number"===r.schema.type&&r.name.endsWith("At")){var _=(0,markdown_types_1.tryParseDate)(l);return(a={})[r.name]=_,a}if("boolean"===r.schema.type)return"true"===l?((i={})[r.name]=!0,i):"false"===l?((m={})[r.name]=!1,m):void 0;if("number"===r.schema.type){var y=Number(l);if(isNaN(y))return;return(s={})[r.name]=y,s}if("null"===r.schema.type){if("null"!==l)return;return(o={})[r.name]=null,o}if("string"===r.schema.type)return(u={})[r.name]=(0,parseFrontmatterString_1.parseFrontmatterString)(l),u;if("array"===r.schema.type){
// turn into comma separated
// Let's only support string[] for now!
var v=l.split(",").map((function(e){return e.trim()})).map(parseFrontmatterString_1.parseFrontmatterString);return(p={})[r.name]=v,p}r.schema.type}})).filter(js_util_1.notEmpty);return(0,js_util_1.mergeObjectsArray)(t)};exports.frontmatterToObject=frontmatterToObject;
//# sourceMappingURL=frontmatterToObject.js.map