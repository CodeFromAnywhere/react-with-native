[{"id":"zwhjFYbHvHyqodWT","commentsInside":[],"rawText":" (p: PackageJSON): string[] => {\n  const dependencies = p.dependencies ? Object.keys(p.dependencies) : [];\n  const devDependencies = p.devDependencies\n    ? Object.keys(p.devDependencies)\n    : [];\n  const peerDependencies = p.peerDependencies\n    ? Object.keys(p.peerDependencies)\n    : [];\n\n  return [...dependencies, ...devDependencies, ...peerDependencies];\n}","name":"getAllPackageJsonDependencies","slug":"get-all-package-json-dependencies","parameters":[{"name":"p","schema":{"$ref":"#/definitions/PackageJSON"},"simplifiedSchema":{"description":"--- defaultDbStorageMethod: jsonSingle\n---","properties":[{"name":"id","required":false,"schema":{"type":"string"}},{"name":"path","required":true,"schema":{"type":"string"}},{"name":"name","required":false,"schema":{"type":"string"}},{"name":"main","required":false,"schema":{"type":"string"}},{"name":"source","required":false,"schema":{"type":"string"}},{"name":"description","required":false,"schema":{"type":"string"}},{"name":"version","required":false,"schema":{"type":"string"}},{"name":"private","required":false,"schema":{"type":"boolean"}},{"name":"author","required":false,"schema":{"properties":[],"type":"object"}},{"name":"repository","required":true,"schema":{"properties":[],"type":"object"}},{"name":"homepage","required":false,"schema":{"type":"string"}},{"name":"dependencies","required":false,"schema":{"properties":[],"type":"object"}},{"name":"devDependencies","required":false,"schema":{"properties":[],"type":"object"}},{"name":"peerDependencies","required":false,"schema":{"properties":[],"type":"object"}},{"name":"bin","required":false,"schema":{"properties":[],"type":"object"}},{"name":"workspaces","required":false,"schema":{"items":[{"schema":{"type":"string"},"name":null}],"type":"array"}},{"name":"type","required":false,"schema":{"description":"# Classification\n\nTODO: think about what the differences are and how we need to change processes to make it all work good\n\n### Possible values\n\njs: only js (no node) (well, ts of course)\n\nnode: includes other node packages, operations, core-imports, or globals.\n\nserver: exposes something on some port when it is ran and uses node code\n\nweb: uses react and exposes something on some port when it is ran\n\napp: uses react-native and exposes something on some port when it is ran\n\nui-es6: uses react (with (native)), which main entry points to typescript es6 files (this ui package cannot be built, should be transpiled)\n\nui-es5: ui which main entry points to javascript es5 files (this ui package can be built)","enum":["js","node","server","web","app","ui-es6","ui-es5"],"type":"string"}},{"name":"sensible","required":false,"schema":{"description":"Sensible-global configurations","properties":[{"name":"isSensibleProject","required":true,"schema":{"type":"boolean"}}],"type":"object"}},{"name":"operation","required":false,"schema":{"description":"anything configurable about the operation.\n\nThis can live in operation.json or as a prop in package.json.","properties":[{"name":"indirectDependencies","required":false,"schema":{"description":"Sometimes you are using function in a UI, which cannot be inferred with imports because they are used indirectly via an api. Here you can specify which operations on the backend are needed for an operation (ui mostly)\n\nThis array is simply a list of operation names needed for this operation that are not imported.\n\nNB: no need to specify things here that you also import in this operation, because these are already automatically detected.","items":[{"schema":{"type":"string"},"name":null}],"type":"array"}}],"type":"object"}}],"type":"object"},"required":true}],"description":"","returnType":{"rawType":"string[]","typeDefinition":{"optional":false,"type":"array","items":{"type":"string","allOf":[{"transform":["trim"]},{"minLength":1}]}},"typeCoverage":0,"isArray":true,"isEnum":false,"isObject":true,"isPrimitive":false,"isEnumLiteral":false,"simplifiedSchema":{"items":[{"schema":{"type":"string"},"name":null}],"type":"array"}},"maxIndentationDepth":2,"relativePathFromProjectRoot":"/tools/control-fs/get-path/src/getOperationClassification.ts","srcFileId":"/getOperationClassification","operationFolderName":"get-path","relativeFilePathFromSrc":"/getOperationClassification.ts","relativeOperationBasePathFromProjectRoot":"/tools/control-fs/get-path","operationName":"get-path","size":{"characters":363,"lines":11,"bytes":363,"bytesPerCharacter":1,"charactersPerfLine":33,"linesPerFile":11,"numberOfFiles":1}},{"id":"vvQcqMoGQHgyXQSo","commentsInside":[],"rawText":" (packageJson: PackageJSON, dependency: string) => {\n  return getAllPackageJsonDependencies(packageJson).includes(dependency);\n}","name":"hasDependency","slug":"has-dependency","parameters":[{"name":"packageJson","schema":{"$ref":"#/definitions/PackageJSON"},"simplifiedSchema":{"description":"--- defaultDbStorageMethod: jsonSingle\n---","properties":[{"name":"id","required":false,"schema":{"type":"string"}},{"name":"path","required":true,"schema":{"type":"string"}},{"name":"name","required":false,"schema":{"type":"string"}},{"name":"main","required":false,"schema":{"type":"string"}},{"name":"source","required":false,"schema":{"type":"string"}},{"name":"description","required":false,"schema":{"type":"string"}},{"name":"version","required":false,"schema":{"type":"string"}},{"name":"private","required":false,"schema":{"type":"boolean"}},{"name":"author","required":false,"schema":{"properties":[],"type":"object"}},{"name":"repository","required":true,"schema":{"properties":[],"type":"object"}},{"name":"homepage","required":false,"schema":{"type":"string"}},{"name":"dependencies","required":false,"schema":{"properties":[],"type":"object"}},{"name":"devDependencies","required":false,"schema":{"properties":[],"type":"object"}},{"name":"peerDependencies","required":false,"schema":{"properties":[],"type":"object"}},{"name":"bin","required":false,"schema":{"properties":[],"type":"object"}},{"name":"workspaces","required":false,"schema":{"items":[{"schema":{"type":"string"},"name":null}],"type":"array"}},{"name":"type","required":false,"schema":{"description":"# Classification\n\nTODO: think about what the differences are and how we need to change processes to make it all work good\n\n### Possible values\n\njs: only js (no node) (well, ts of course)\n\nnode: includes other node packages, operations, core-imports, or globals.\n\nserver: exposes something on some port when it is ran and uses node code\n\nweb: uses react and exposes something on some port when it is ran\n\napp: uses react-native and exposes something on some port when it is ran\n\nui-es6: uses react (with (native)), which main entry points to typescript es6 files (this ui package cannot be built, should be transpiled)\n\nui-es5: ui which main entry points to javascript es5 files (this ui package can be built)","enum":["js","node","server","web","app","ui-es6","ui-es5"],"type":"string"}},{"name":"sensible","required":false,"schema":{"description":"Sensible-global configurations","properties":[{"name":"isSensibleProject","required":true,"schema":{"type":"boolean"}}],"type":"object"}},{"name":"operation","required":false,"schema":{"description":"anything configurable about the operation.\n\nThis can live in operation.json or as a prop in package.json.","properties":[{"name":"indirectDependencies","required":false,"schema":{"description":"Sometimes you are using function in a UI, which cannot be inferred with imports because they are used indirectly via an api. Here you can specify which operations on the backend are needed for an operation (ui mostly)\n\nThis array is simply a list of operation names needed for this operation that are not imported.\n\nNB: no need to specify things here that you also import in this operation, because these are already automatically detected.","items":[{"schema":{"type":"string"},"name":null}],"type":"array"}}],"type":"object"}}],"type":"object"},"required":true},{"name":"dependency","schema":{"type":"string"},"simplifiedSchema":{"type":"string"},"required":true}],"description":"","returnType":{"rawType":"any","typeCoverage":0,"isArray":false,"isEnum":false,"isObject":false,"isPrimitive":false,"isEnumLiteral":false},"maxIndentationDepth":1,"relativePathFromProjectRoot":"/tools/control-fs/get-path/src/getOperationClassification.ts","srcFileId":"/getOperationClassification","operationFolderName":"get-path","relativeFilePathFromSrc":"/getOperationClassification.ts","relativeOperationBasePathFromProjectRoot":"/tools/control-fs/get-path","operationName":"get-path","size":{"characters":128,"lines":3,"bytes":128,"bytesPerCharacter":1,"charactersPerfLine":42.666666666666664,"linesPerFile":3,"numberOfFiles":1}},{"id":"qWrCOtnzPSODViBV","commentsInside":[],"rawText":" (\n  folderPath: string\n): OperationClassification | undefined => {\n  const packageJsonPath = path.join(folderPath, \"package.json\");\n  const tsConfigPath = path.join(folderPath, \"tsconfig.json\");\n  const nextConfigPath = path.join(folderPath, \"next.config.js\");\n  const appJsonPath = path.join(folderPath, \"app.json\");\n\n  const existsPackageJson = fs.existsSync(packageJsonPath);\n  const existsTsConfig = fs.existsSync(tsConfigPath);\n  const existsNextConfig = fs.existsSync(nextConfigPath);\n  const existsAppJson = fs.existsSync(appJsonPath);\n  if (!existsPackageJson || !existsTsConfig) return;\n\n  const packageJson = tryParseJson<PackageJSON>(\n    fs.readFileSync(packageJsonPath, \"utf8\")\n  );\n\n  if (!packageJson || packageJson.workspaces) {\n    return;\n  }\n\n  const isNextApp = existsNextConfig;\n  const isReactNativeApp = existsAppJson;\n  const isReactPackage =\n    hasDependency(packageJson, \"react\") ||\n    hasDependency(packageJson, \"react-native\") ||\n    hasDependency(packageJson, \"next\") ||\n    hasDependency(packageJson, \"expo\");\n\n  const mainEntryTypescriptSource =\n    !!packageJson.main &&\n    packageJson.main.startsWith(\"src/\") &&\n    (packageJson.main.endsWith(\".ts\") || packageJson.main.endsWith(\".tsx\"));\n\n  const hasExpress = hasDependency(packageJson, \"express\");\n  const hasServer = hasDependency(packageJson, \"server\");\n  const hasTypesNode = hasDependency(packageJson, \"@types/node\");\n\n  const classification: OperationClassification = isNextApp\n    ? \"web\"\n    : isReactNativeApp\n    ? \"app\"\n    : isReactPackage && mainEntryTypescriptSource\n    ? \"ui-es6\"\n    : isReactPackage && !mainEntryTypescriptSource\n    ? \"ui-es5\"\n    : hasExpress || hasServer\n    ? \"server\"\n    : hasTypesNode\n    ? \"node\"\n    : \"js\";\n\n  return classification;\n}","name":"getOperationClassification","slug":"get-operation-classification","parameters":[{"name":"folderPath","schema":{"type":"string"},"simplifiedSchema":{"type":"string"},"required":true}],"description":"returns OperationClassification if it's an operation, or undefined if it's not\n\nNB: don't confuse this with ProjectType or ImportClassification","returnType":{"rawType":"import(\"/Users/king/King/tools/types/code-types/build/OperationIndex\").OperationClassification | undefined","typeDefinition":{"optional":true,"enum":["js","node","server","web","app","ui-es6","ui-es5"],"x-enumNames":["js","node","server","web","app","ui-es6","ui-es5"],"type":"string"},"typeCoverage":0,"isArray":false,"isEnum":false,"isObject":false,"isPrimitive":false,"isEnumLiteral":false,"simplifiedSchema":{"enum":["js","node","server","web","app","ui-es6","ui-es5"],"type":"string"}},"maxIndentationDepth":2,"relativePathFromProjectRoot":"/tools/control-fs/get-path/src/getOperationClassification.ts","srcFileId":"/getOperationClassification","operationFolderName":"get-path","relativeFilePathFromSrc":"/getOperationClassification.ts","relativeOperationBasePathFromProjectRoot":"/tools/control-fs/get-path","operationName":"get-path","size":{"characters":1909,"lines":57,"bytes":1909,"bytesPerCharacter":1,"charactersPerfLine":33.49122807017544,"linesPerFile":57,"numberOfFiles":1}}]